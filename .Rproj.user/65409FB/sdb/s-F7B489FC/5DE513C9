{
    "collab_server" : "",
    "contents" : "---\ntitle: \"Flexdashboard with opencpu back-end\"\noutput: \n  flexdashboard::flex_dashboard:\n    theme: cerulean\n    orientation: rows\n    logo: testlogo.png\n    social: [ \"twitter\", \"facebook\"]\n    navbar:\n      - { title: \"About\", href: \"http://data-laborer.eu\", align: right }\n---\n\n<script src=\"inst/www/jquery-1.10.2.min.js\"> </script>\n<script src=\"inst/www/opencpu-0.4.js\"> </script>\n\n<script> \n\n$(function(){\n    \n  var paramid = 1;\n\n  $('#myBtn').click( function () {\n    \n    $('#myBtn').hide();\n    $('iframe').css({'display': 'inline'}); \n    \n    var req2 = ocpu.call(\"make_map\", {\n        title : 'Chez Mamie'\n      }, function(session){\n        $('iframe').attr('src', session.getFileURL('mymap.html'));\n      });\n  });\n\n  var jsonReqtime = ocpu.call(\"gethowel\",{\n      \t\tid : Number(paramid)\n      \t}, function(session){\n      \t\n      \tsession.getObject(function(outtxt){\n      \t\t$(\"#json_output\").text(outtxt);\n      \t\t\n      \t\tvar age_json = JSON.parse(outtxt[0])[0][\"age\"];\n      \t\t$('#age .value').text(age_json);\n      \t\t if (age_json <= 21) {var color_age = '#01bb69';\n      \t\t  } else if (age_json <= 60) {var color_age = '#ff8039';\n      \t      } else {var color_age = '#fb305a';}\n      \t\t$('#age').css(\"background-color\", color_age);\n      \t\t\n      \t\tvar height_json = JSON.parse(outtxt[0])[0][\"height\"];\n      \t\t$('#height .value').text(height_json);\n      \t\t if (height_json <= 140) {var color_income = '#ff8039';\n      \t\t  } else if (height_json >= 160) {var color_income = '#fb305a';\n      \t      } else {var color_income = '#01bb69';}\n      \t\t$('#height').css(\"background-color\", color_income);\n      \t\t\n      \t\tvar weight_json = JSON.parse(outtxt[0])[0][\"weight\"];\n      \t\t$('#weight .value').text(weight_json);\n      \t\t if (weight_json <= 20) {var color_asset = '#ff8039';\n      \t\t  } else if (weight_json <= 40) {var color_asset = '#fb305a';\n      \t      } else {var color_asset = '#01bb69';}\n      \t\t$('#weight').css(\"background-color\", color_asset);\n      \t\t\n      \t\t$('#id .value').text(JSON.parse(outtxt[0])[0][\"id\"]);\n      \t\t\n      \t\tvar male_json = JSON.parse(outtxt[0])[0][\"male\"];\n      \t\t$('#sex .value').text(male_json);\n      \t\t\t if (male_json === 0) {var color_male = '#ae6df8';\n      \t\t  } else {var color_male = '#02a8ee';}\n      \t\t$('#sex').css(\"background-color\", color_male);\n      \t\t\n      \t});\n  });\n  \n  var req = $(\"#plotdiv\").rplot(\"plotind\", {id : Number(paramid)});\n  var req = $(\"#plotdivsex\").rplot(\"plotindsex\", {id : Number(paramid)});\n  var req = $(\"#plotdivsex2\").rplot(\"plotindsex2\", {id : Number(paramid)});\n\n});\n\n$(function(){\n  $(\"#idsubmit\").click(function(e){\n  \n  var paramid = $(\"#myid\").val();\n  \n  var jsonReqtime = ocpu.call(\"gethowel\",{\n    \t\tid : Number(paramid)\n    \t}, function(session){\n    \t\n    \tsession.getObject(function(outtxt){\n    \t\t$(\"#json_output\").text(outtxt);\n    \t\t\n      \t\tvar age_json = JSON.parse(outtxt[0])[0][\"age\"];\n      \t\t$('#age .value').text(age_json);\n      \t\t if (age_json <= 21) {var color_age = '#01bb69';\n      \t\t  } else if (age_json <= 60) {var color_age = '#ff8039';\n      \t      } else {var color_age = '#fb305a';}\n      \t\t$('#age').css(\"background-color\", color_age);\n      \t\t\n      \t\tvar height_json = JSON.parse(outtxt[0])[0][\"height\"];\n      \t\t$('#height .value').text(height_json);\n      \t\t if (height_json <= 140) {var color_income = '#ff8039';\n      \t\t  } else if (height_json >= 160) {var color_income = '#fb305a';\n      \t      } else {var color_income = '#01bb69';}\n      \t\t$('#height').css(\"background-color\", color_income);\n      \t\t\n      \t\tvar weight_json = JSON.parse(outtxt[0])[0][\"weight\"];\n      \t\t$('#weight .value').text(weight_json);\n      \t\t if (weight_json <= 20) {var color_asset = '#ff8039';\n      \t\t  } else if (weight_json <= 40) {var color_asset = '#fb305a';\n      \t      } else {var color_asset = '#01bb69';}\n      \t\t$('#weight').css(\"background-color\", color_asset);\n      \t\t\n      \t\t$('#id .value').text(JSON.parse(outtxt[0])[0][\"id\"]);\n      \t\t\n      \t\tvar male_json = JSON.parse(outtxt[0])[0][\"male\"];\n      \t\t$('#sex .value').text(male_json);\n      \t\t\t if (male_json === 0) {var color_male = '#ae6df8';\n      \t\t  } else {var color_male = '#02a8ee';}\n      \t\t$('#sex').css(\"background-color\", color_male);\n      \t\t    \t\t\n    \t});\n    });\n    \n    var req = $(\"#plotdiv\").rplot(\"plotind\", {id : Number(paramid)});\n    var req = $(\"#plotdivsex\").rplot(\"plotindsex\", {id : Number(paramid)});\n  var req = $(\"#plotdivsex2\").rplot(\"plotindsex2\", {id : Number(paramid)});\n\n  });\n\n});\n  \n</script>\n\n```{r setup, include=FALSE}\n# devtools::install_github(\"Rstudio/flexdashboard\")\nlibrary(flexdashboard)\n```\n\nPage 1\n===================================== \n\nRow {data-height=200}\n-------------------------------------\n\n### Definition {data-width=800}\n\nTest for a dashboard with opencpu.\nLoading a page is slow due to the size of the web page loaded: so far 1.4 Mb.\n\nMost of the size is due to the flexdashboard interface (multiple pages & tab adjustment).\n\nThere is a trade off between the complexity of the page (mobile compatible or not, multiple pages, etc.) and the size of the page.\n\n### Selection (integer between 1 and 645) {data-width=200}\n\n<input type=\"integer\" class=\"form-control\" id=\"myid\" value=\"1\" style = \"width: 90%;\">\n\n<button type=\"submit\" id=\"idsubmit\" class=\"btn btn-default\">Update dashboard!</button>\n \nRow {data-height=200}\n-----------------------------------------------------------------------\n\n### Age\n\n```{r valuebox1}\nvalueBox(0, icon = \"fa-pencil\", color = '#01bb69')\n```\n\n### Height\n\n```{r valuebox2}\nvalueBox(0, icon = \"fa-envelope-o\", color = '#ff8039')\n```\n\n### Weight\n\n```{r valuebox3}\nvalueBox(0, icon = \"fa-trash\", color = '#fb305a')\n```\n\n### Id\n\n```{r}\nvalueBox(0, icon = \"fa-puzzle-piece\")\n```\n\n### Sex\n\n```{r}\nvalueBox(0, icon = \"fa-money\", color = '#02a8ee')\n```\n\nRow {data-height=200}\n-----------------------------------------------------------------------\n\n### Indicator 1\n\n```{r}\ngauge(90, min = 0, max = 100, gaugeSectors(\n  success = c(80, 100), warning = c(40, 79), danger = c(0, 39)\n))\n```\n\n### Indicator 2\n\n```{r}\ngauge(30, min = 0, max = 100, gaugeSectors(\n  success = c(41, 50), warning = c(21, 40), danger = c(0, 20)\n))\n```\n\n### Indicator 3\n\n```{r}\ngauge(8, min = 0, max = 100, gaugeSectors(\n  success = c(0, 2), warning = c(3, 6), danger = c(7, 10)\n))\n```\n\nRow {data-height=400}\n-----------------------------------------------------------------------\n\n### Age, Weight and Height Graphs\n\n<div id=\"plotdiv\" style='height: 270px'></div> \n\nPage 2\n===================================== \n\nRow {data-height=300}\n-----------------------------------------------------------------------\n\n### Age Height by Sex\n\n```{r, fig.width=15}\ndata(\"howell\")\n\nggplot2::ggplot(data = howell, ggplot2::aes(x = age, y = height, color = male)) +\n  ggplot2::geom_point()\n```\n\n### Age Weight by Sex\n\n```{r, fig.width=15}\ndata(\"howell\")\n\nggplot2::ggplot(data = howell, ggplot2::aes(x = age, y = weight, color = male)) +\n  ggplot2::geom_point()\n```\n\nRow {data-height=700}\n-----------------------------------------------------------------------\n\n### Mapping\n\n<button type=\"button\" id=\"myBtn\" >Map</button>\n\n<iframe src=\"about:blank\" style='height: 620px;width: 1300px;display: none;'></iframe>\n",
    "created" : 1477938886059.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "2751593954",
    "id" : "5DE513C9",
    "lastKnownWriteTime" : 1477941401,
    "last_content_update" : 1477941401069,
    "path" : "~/GitHub/flexocpu/Index.Rmd",
    "project_path" : "Index.Rmd",
    "properties" : {
    },
    "relative_order" : 1,
    "source_on_save" : false,
    "source_window" : "",
    "type" : "r_markdown"
}